
// File.cpp
//============================================================================//
// 概要：なし。
// 補足：なし。
//============================================================================//

#include "File.h"
#include "define.h"
#include "util\uPath.h"


/******************************************************************************/
//		コンストラクタおよびデストラクタ
/******************************************************************************/
// コンストラクタ
//============================================================================//
// 概要：なし。
// 補足：なし。
//============================================================================//

File::File(FileInfo* p)
: strArchivePath(p->strArchivePath), 
strFilePath(p->strFilePath), 
blnCompressed(p->blnCompressed), 
uiStartPoint(p->uiStartPoint), 
uiEndPoint(p->uiEndPoint)
{
}


/******************************************************************************/
// デストラクタ
//============================================================================//
// 概要：なし。
// 補足：なし。
//============================================================================//

File::~File()
{
}



/******************************************************************************/
//		取得
/******************************************************************************/
// ファイル名取得
//============================================================================//
// 概要：なし。
// 補足：なし。
//============================================================================//

string File::GetFileName() const 
{
	return ::GetFileName(strFilePath);
}


/******************************************************************************/
// ディレクトリ取得
//============================================================================//
// 概要：なし。
// 補足：なし。
//============================================================================//

string File::GetFileDir() const
{
	return GetDirName(strFilePath) ;
}


/******************************************************************************/
// 再生時間取得
//============================================================================//
// 概要：デフォルトは０ミリ秒。
// 補足：なし。
//============================================================================//

ULONG File::GetPlayLength()
{
	return 0 ;
}


/******************************************************************************/
// ヘッダ読み取り
//============================================================================//
// 概要：なし。
// 補足：なし。
//============================================================================//

BOOL File::ReadHeader()
{
	return TRUE;
}


/******************************************************************************/
//		表示名取得
/******************************************************************************/
// リスト追加用の文字列を取得
//============================================================================//
// 概要：なし。
// 補足：なし。
//============================================================================//

string File::GetDisplayStr( const string& s)
{
	string	strRet ;
	string	strVal ;
	BOOL	blnEncode = FALSE ;

	for( int i = 0; i < s.size(); i++)
	{
		if( blnEncode)
		{
			if( s[ i] != '%')
			{
				strVal += s[ i] ;
			}
			else
			{
				if( strVal == "")
				{
					strRet += '%' ;
				}
				else
				{
					strRet += GetVariable( strVal) ;
				}

				blnEncode = FALSE ;
			}
		}
		else
		{
			if( s[ i] == '%')
			{
				blnEncode = TRUE ;
				strVal = "" ;
			}
			else
			{
				strRet += s[ i] ;
			}
		}
	}
	return strRet ;
}


/******************************************************************************/
// 変数展開
//============================================================================//
// 概要：なし。
// 補足：なし。
//============================================================================//

string File::GetVariable( const string& strVal)
{
	if( strVal == "FILE_NAME")
	{
		return GetFileName() ;
	}
	else if( strVal == "FILE_PATH")
	{
		return GetFilePath() ;
	}

	return "" ;
}
